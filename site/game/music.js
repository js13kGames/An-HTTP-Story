import { delay } from "./utils";

// prettier-ignore
const songs = {
  404: [[[.5,0,,,,2,1],[.5,0,440,,,2,1],[.8,0,2100,,,.2,3,3,,,-400,,,2],[.5,0,655,,,.09,3,1.65,,,,,.02,3.8,-.1,,.2],[2,0,110,,,2,1,,,,,,,,,,,1.5]],[[[,,13,,,,16,,,,18,,,,20,,,,13,,,,16,,,,18,,,,20,,,,11,,,,15,,,,16,,,,18,,,,11,,,,15,,,,16,,,,18,,,,],[2,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,]],[[,,13,,,,16,,,,18,,,,20,,,,13,,,,16,,,,18,,,,20,,,,11,,,,15,,,,16,,,,18,,,,11,,,,15,,,,16,,,,18,,,,],[2,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,],[3,,36,,36,,,,30,,36,,36,,,,30,,36,,,36,,30,,,36,,,36,,30,,,36,,36,,,,30,,36,,36,,,,30,,36,,,36,,30,,,36,,36,,,,30,,]],[[,,13,,,,16,,,,18,,,,20,,,,13,,,,16,,,,18,,,,20,,,,11,,,,15,,,,16,,,,18,,,,11,,,,15,,,,16,,,,18,,,,],[2,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,],[3,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,],[1,,32,,27,,28,,25,,,,,,,,,,,,,,,,,,,,,,,,,,30,,27,,28,,25,,,,,,,,,,,,,,,,,,,,,,,,,,,]],[[,,13,,,,16,,,,18,,,,20,,,,13,,,,16,,,,18,,,,20,,,,11,,,,15,,,,16,,,,18,,,,11,,,,15,,,,16,,,,18,,,,],[2,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,],[3,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,],[1,,32,,27,,28,,25,,,,,,,,,,,,,,,,,,,,,,,,,,30,,27,,28,,25,,,,,,,,,,,,,,,,,,,,,,,,,,,],[4,,13,,,,,,13,,20,,,,15,,,,13,,,,,,,,16,,,,18,,,,11,,,,,,11,,18,,,,15,,,,11,,,,,,,,,,,,,,,,]]],[0,1,2,2,3,3],100],
  urgency: [],
};

let audio;
export async function playMusic(name = "404") {
  const song = songs[name];
  const songData = zzfxM(...song);

  await stopMusic();
  audio = zzfxP(...songData);
  audio.loop = true;

  // const volume = audio.context.createGain();
  // volume.gain.value = 0.3;
  // volume.connect(audio.context.destination);
  // audio.connect(volume);
  // audio._volume = volume; // Probably some better way to expose this

  return audio;
}

export async function stopMusic() {
  if (audio) {
    // audio._volume.gain.linearRampToValueAtTime(
    //   0,
    //   audio.context.currentTime + 3
    // );
    // await delay(5000);
    audio.stop();
  }
}

// window.stop = stopMusic;
